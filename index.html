<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="style.css" type="text/css">
    <title>OpenGL and Three.js App</title>
    <script src="https://threejs.org/build/three.js"></script>
    <script src="app.js"></script>
</head>

<body>
    <nav class="nav navbar">
        <ul class="nav">
            <li class="nav-item"><a class="nav-link active" aria-current="page" href="#">Home</a></li>
            <li class="nav-item"><a class="nav-link" href="open.php">Open</a></li>
            <li class="nav-item"><a class="nav-link" href="save.php">Save</a></li>
            <li class="nav-item"><a class="nav-link" href="export.php">Export</a></li>
            <li class="nav-item"><a class="nav-link" href="code.php">Three.js Code</a></li>
        </ul>
    </nav>

    <main>
        <section id="editor">
            <h2>Three.js Code Editor</h2>
            <textarea id="threejs-code" rows="10" cols="50" placeholder="Write your Three.js code here..."></textarea>
            <button id="run-code">Run Code</button>
        </section>

        <section id="canvas-container">
            <h2>Three.js Canvas</h2>
            <div id="canvas"></div>
        </section>
    </main>

    <script>
        const canvasContainer = document.getElementById("canvas");
        const threejsCode = document.getElementById("threejs-code");
        const runCodeButton = document.getElementById("run-code");

        // Funzione per eseguire il codice Three.js inserito dall'utente
        function runThreejsCode() {
            try {
                // Rimuovi il contenuto precedente del canvas
                while (canvasContainer.firstChild) {
                    canvasContainer.removeChild(canvasContainer.firstChild);
                }

                // Crea un nuovo contesto Three.js
                const scene = new THREE.Scene();
                const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
                const renderer = new THREE.WebGLRenderer();
                renderer.setSize(window.innerWidth, window.innerHeight);
                canvasContainer.appendChild(renderer.domElement);

                // Esegui il codice Three.js dell'utente
                eval(threejsCode.value);

                // Funzione di animazione
                function animate() {
                    requestAnimationFrame(animate);
                    renderer.render(scene, camera);
                }
                animate();
            } catch (error) {
                console.error("Errore nell'esecuzione del codice Three.js:", error);
            }
        }

        // Evento per il pulsante "Run Code"
        runCodeButton.addEventListener("click", runThreejsCode);
    </script>
</body>

</html>
